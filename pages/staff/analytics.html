<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LGU Staff Dashboard - WaterSense Analytics</title>

    <!-- Global CSS -->
    <link rel="stylesheet" href="../../css/main.css">

    <!-- External modules (unchanged) -->
    <script type="module" async src="https://l1nq.com/rvNGG"></script>
    <script type="module" defer src="https://sl1nk.com/REegY"></script>
</head>

<body class="bg-background min-h-screen">
    <!-- Top Navigation Bar -->
    <nav class="bg-surface border-b border-border shadow-sm sticky top-0 z-50">
        <div class="max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">

                <div class="flex items-center justify-between w-full mr-2">
                    <!-- Logo and Title - Left Side -->
                    <div class="flex items-center gap-3">
                        <!-- Logo - Smaller on mobile -->
                        <svg class="w-8 h-8 sm:w-10 sm:h-10" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect width="40" height="40" rx="8" fill="#2563EB"/>
                            <path d="M20 8C15.5817 8 12 11.5817 12 16C12 20.4183 15.5817 24 20 24C24.4183 24 28 20.4183 28 16C28 11.5817 24.4183 8 20 8Z" fill="white" opacity="0.3"/>
                            <path d="M12 24H28V32C28 33.1046 27.1046 34 26 34H14C12.8954 34 12 33.1046 12 32V24Z" fill="white"/>
                            <rect x="18" y="26" width="4" height="6" fill="#2563EB"/>
                        </svg>
                        <div>
                            <!-- Title - Smaller on mobile -->
                            <h1 class="text-base sm:text-lg font-semibold text-text-primary">WaterSense</h1>
                        </div>
                    </div>

                    <!-- Mobile Menu Button - Visible on mobile -->
                    <button id="mobileMenuButton" class="md:hidden p-2 rounded-md text-text-secondary hover:text-primary hover:bg-secondary-50 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>

                    <!-- Desktop Navigation Links - Hidden on mobile -->
                    <div class="hidden md:flex items-center gap-6">
                        <a href="dashboard.html" class="text-text-secondary hover:text-primary transition-colors">Dashboard</a>
                        <a href="reports.html" class="text-text-secondary hover:text-primary transition-colors">Reports</a>
                        <a href="analytics.html" class="text-primary font-medium border-b-2 border-primary pb-1">Analytics</a>
                    </div>
                </div>

                <!-- Mobile Menu Overlay -->
                <div id="mobileMenu" class="md:hidden hidden fixed top-1/3 right-4 -translate-y-1/2 w-72 bg-surface border border-border shadow-lg rounded-xl z-50">

                    <div class="h-[64px] border-b border-border flex items-center px-4">
                        <span class="text-lg font-semibold text-primary">Menu</span>
                    </div>

                    <div class="px-4 py-4 space-y-2">
                        <a href="dashboard.html"
                        class="flex items-center gap-3 px-4 py-3 rounded-lg text-text-secondary hover:bg-secondary-50 hover:text-primary transition">
                            Dashboard
                        </a>

                        <a href="reports.html"
                        class="flex items-center gap-3 px-4 py-3 rounded-lg text-text-secondary hover:bg-secondary-50 hover:text-primary transition">
                            Reports
                        </a>

                        <a href="analytics.html"
                        class="flex items-center gap-3 px-4 py-3 rounded-lg bg-primary-50 text-primary font-medium">
                            Analytics 	
                        </a>
                    </div>
                </div>



                <!-- User Profile -->
                <div class="flex items-center gap-3 mr-2 sm:mr-0">
                    <div class="hidden sm:block text-right">

                    </div>
                    
                  
                    
                    <button id="logoutBtn" class="btn btn-outline py-2 px-3 text-sm min-h-[44px] mr-2 sm:mr-0" 
                            onclick="window.location.href='../auth/login.html'">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                        </svg>
                        <span class="hidden xs:inline">Logout</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Control Bar -->
    <div class="bg-surface border-b border-border">
        <div class="max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
                <!-- Location Info -->
                <div class="flex items-center gap-3">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-warning-500 rounded-full"></div>
                        <span class="text-sm font-medium text-text-primary">Barangay Lingga</span>
                    </div>
                </div>

                <!-- Time Range and Actions -->
                
            </div>
            
            <!-- Last Update Timestamp -->
            <div class="mt-3 flex items-center gap-2 text-xs text-text-secondary">
                <span class="status-indicator status-normal status-pulse"></span>
                <span>Last updated: <span id="lastUpdate">12/13/2025 12:32 AM</span></span>
                <span class="mx-2">•</span>
                <span>Next refresh in: <span id="nextRefresh">4:58</span></span>
            </div>
        </div>
    </div>



        <!-- Main Visualization and Alert Panel -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 mb-6">
            <!-- Trend Analysis Chart (8 cols) -->
            <div class="lg:col-span-8 card card-comfortable">
                <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 gap-3">
                    <div>
                        <h3 class="text-lg font-semibold text-text-primary">24-Hour Water Level Trend</h3>
                        <p class="text-sm text-text-secondary">Comparative analysis with historical patterns</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <button class="btn btn-outline py-2 px-3 text-sm">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/>
                            </svg>
                            Filter
                        </button>
                        <button class="btn btn-outline py-2 px-3 text-sm">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                            </svg>
                            Export
                        </button>
                    </div>
                </div>

                <!-- Chart Container -->
                <div class="relative bg-secondary-50 rounded-md p-4 mb-4" style="height: 400px;">
                    <svg class="w-full h-full" viewBox="0 0 800 350" preserveAspectRatio="xMidYMid meet">
                        <!-- Grid Lines -->
                        <g class="grid-lines" stroke="#CBD5E1" stroke-width="1" opacity="0.3">
                            <line x1="60" y1="50" x2="760" y2="50"/>
                            <line x1="60" y1="110" x2="760" y2="110"/>
                            <line x1="60" y1="170" x2="760" y2="170"/>
                            <line x1="60" y1="230" x2="760" y2="230"/>
                            <line x1="60" y1="290" x2="760" y2="290"/>
                        </g>

                        <!-- Y-Axis Labels -->
                        <g class="y-axis-labels font-data" fill="#64748B" font-size="12">
                            <text x="45" y="55" text-anchor="end">150cm</text>
                            <text x="45" y="115" text-anchor="end">120cm</text>
                            <text x="45" y="175" text-anchor="end">90cm</text>
                            <text x="45" y="235" text-anchor="end">60cm</text>
                            <text x="45" y="295" text-anchor="end">30cm</text>
                        </g>

                        <!-- Threshold Lines -->
                        <line x1="60" y1="110" x2="760" y2="110" stroke="#DC2626" stroke-width="2" stroke-dasharray="5,5" opacity="0.5"/>
                        <line x1="60" y1="170" x2="760" y2="170" stroke="#D97706" stroke-width="2" stroke-dasharray="5,5" opacity="0.5"/>

                        <!-- Barangay Lingga Line (Current) -->
                        <polyline points="60,190 120,185 180,180 240,175 300,170 360,165 420,160 480,155 540,160 600,165 660,170 720,175 760,180" 
                                  fill="none" stroke="#D97706" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>

                        <!-- Historical Pattern (Dashed) -->
                        <polyline points="60,210 120,208 180,205 240,202 300,200 360,198 420,195 480,198 540,200 600,202 660,205 720,208 760,210" 
                                  fill="none" stroke="#94A3B8" stroke-width="2" stroke-dasharray="5,5" opacity="0.6"/>

                        <!-- Data Point -->
                        <circle cx="760" cy="180" r="5" fill="#D97706" stroke="white" stroke-width="2"/>

                        <!-- X-Axis Labels -->
                        <g class="x-axis-labels" fill="#64748B" font-size="11">
                            <text x="60" y="320" text-anchor="middle">12 AM</text>
                            <text x="180" y="320" text-anchor="middle">4 AM</text>
                            <text x="300" y="320" text-anchor="middle">8 AM</text>
                            <text x="420" y="320" text-anchor="middle">12 PM</text>
                            <text x="540" y="320" text-anchor="middle">4 PM</text>
                            <text x="660" y="320" text-anchor="middle">8 PM</text>
                            <text x="760" y="320" text-anchor="middle">12 AM</text>
                        </g>
                    </svg>
                </div>

                <!-- Chart Legend -->
                <div class="flex flex-wrap items-center justify-center gap-6 text-sm">
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-1 bg-warning-600 rounded"></div>
                        <span class="text-text-secondary">Barangay Lingga</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-1 bg-secondary-400 rounded" style="background-image: repeating-linear-gradient(90deg, #94A3B8 0, #94A3B8 5px, transparent 5px, transparent 10px);"></div>
                        <span class="text-text-secondary">Historical Average</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-1 bg-error-600 rounded" style="background-image: repeating-linear-gradient(90deg, #DC2626 0, #DC2626 5px, transparent 5px, transparent 10px);"></div>
                        <span class="text-text-secondary">Critical (120cm)</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-1 bg-warning-600 rounded" style="background-image: repeating-linear-gradient(90deg, #D97706 0, #D97706 5px, transparent 5px, transparent 10px);"></div>
                        <span class="text-text-secondary">Warning (90cm)</span>
                    </div>
                </div>
            </div>

            <!-- Alert Summary Panel (4 cols) -->
            <div class="lg:col-span-4 space-y-4">
                <!-- Alert Frequency Summary -->
                <div class="card card-comfortable">
                    <h4 class="font-semibold text-text-primary mb-4">Alert Summary (24h)</h4>
                    
                    <div class="space-y-4">
                        <!-- Critical Alerts -->
                        <div class="flex items-center justify-between p-3 bg-error-50 rounded-md">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-error-100 rounded-md flex items-center justify-center">
                                    <svg class="w-6 h-6 text-error-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-text-primary">Critical</p>
                                    <p class="text-xs text-text-secondary">High priority alerts</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-2xl font-bold text-error-600" data-alert="EMERGENCY">0</p>

                                <p class="text-xs text-text-secondary">alerts</p>
                            </div>
                        </div>

                        <!-- Warning Alerts -->
                        <div class="flex items-center justify-between p-3 bg-warning-50 rounded-md">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-warning-100 rounded-md flex items-center justify-center">
                                    <svg class="w-6 h-6 text-warning-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-text-primary">Warning</p>
                                    <p class="text-xs text-text-secondary">Caution level alerts</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-2xl font-bold text-warning-600" data-alert="WARNING">0</p>

                                <p class="text-xs text-text-secondary">alerts</p>
                            </div>
                        </div>

                        <!-- Info Alerts -->
                        <div class="flex items-center justify-between p-3 bg-accent-50 rounded-md">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-accent-100 rounded-md flex items-center justify-center">
                                    <svg class="w-6 h-6 text-accent-600" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-text-primary">Information</p>
                                    <p class="text-xs text-text-secondary">General updates</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-2xl font-bold text-accent-600" data-alert="CAUTION">0</p>

                                <p class="text-xs text-text-secondary">alerts</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Escalations -->
                <div class="card card-comfortable">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-text-primary">Recent Escalations</h4>
                        <span class="badge badge-warning">3 Active</span>
                    </div>
                    
                   <div id="recentAlerts" class="space-y-3"></div>

                </div>

                <!-- Community Notification Status -->
                
            </div>
        </div>

        <!-- Daily Statistics Table -->
        <div class="card card-comfortable">
            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 gap-3">
                <div>
                    <h3 class="text-lg font-semibold text-text-primary">Daily Statistics Summary</h3>
                    <p class="text-sm text-text-secondary">Comprehensive metrics for operational reporting</p>
                </div>
                <div class="flex items-center gap-2">
                    <button class="btn btn-outline py-2 px-3 text-sm">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/>
                        </svg>
                        Sort
                    </button>
                    <button class="btn btn-primary py-2 px-3 text-sm">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        Export Excel
                    </button>
                </div>
            </div>

            <!-- Responsive Table -->
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-secondary-50 border-b border-border">
                        <tr>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider">Location</th>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider">Current Level</th>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider">Peak Level (24h)</th>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider">Alert Count</th>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider">Notifications Sent</th>
                            <th class="px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider">Status</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-border">
                        <tr class="hover:bg-secondary-50 transition-colors">
                            <td class="px-4 py-4">
                                <div class="flex items-center gap-2">
                                    <div class="w-2 h-2 bg-warning-500 rounded-full"></div>
                                    <span class="font-medium text-text-primary">Barangay Lingga</span>
                                </div>
                            </td>
                            <td class="px-4 py-4">
                                <span class="font-data text-text-primary">93 cm</span>
                            </td>
                            <td class="px-4 py-4">
                                <span class="font-data text-text-primary">95 cm</span>
                            </td>
                            <td class="px-4 py-4">
                                <span class="badge badge-warning">8</span>
                            </td>
                            <td class="px-4 py-4">
                                <span class="text-text-primary">123</span>
                            </td>
                            <td class="px-4 py-4">
                                <span class="badge badge-warning">Caution</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Table Footer Summary -->
            <div class="mt-4 pt-4 border-t border-border grid grid-cols-2 sm:grid-cols-4 gap-4">
                <div class="text-center">
                    <p class="text-xs text-text-secondary mb-1">Total Alerts</p>
                    <p class="text-lg font-semibold text-text-primary">8</p>
                </div>
                <div class="text-center">
                    <p class="text-xs text-text-secondary mb-1">Total Notifications</p>
                    <p class="text-lg font-semibold text-text-primary">123</p>
                </div>
                <div class="text-center">
                    <p class="text-xs text-text-secondary mb-1">Avg Response Time</p>
                    <p class="text-lg font-semibold text-text-primary">2.1 min</p>
                </div>
                <div class="text-center">
                    <p class="text-xs text-text-secondary mb-1">Engagement Rate</p>
                    <p class="text-lg font-semibold text-success-600">95.8%</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-surface border-t border-border mt-12">
        <div class="max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                <p class="text-sm text-text-secondary">© 2025 WaterSense Dashboard. All Rights Reserved.</p>
                <div class="flex items-center gap-4">
                    <a href="javascript:void(0)" class="text-sm text-text-secondary hover:text-primary transition-colors">Documentation</a>
                    <a href="javascript:void(0)" class="text-sm text-text-secondary hover:text-primary transition-colors">Support</a>
                    <a href="javascript:void(0)" class="text-sm text-text-secondary hover:text-primary transition-colors">Privacy Policy</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Shared menu -->
    <script src="../../js/shared/menu.js"></script>

    <!-- Analytics logic -->
    <script src="../../js/staff/analytics.js"></script>

    <!-- External injector -->
    <script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>

</body>
</html>